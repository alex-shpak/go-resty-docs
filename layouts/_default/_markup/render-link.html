{{- $destination := .Destination -}}
{{- if .Page.Site.Params.BookPortableLinks -}}
  {{- $destination = partial "docs/links/portable-link" . -}}
{{- end -}}
{{- $u := urls.Parse $destination -}}
<a href="{{ .Destination | safeURL }}"
  {{- with .Title }} title="{{ . }}"{{ end -}}
  {{- if $u.IsAbs }} rel="external" target="_blank"{{ end -}}
>
  {{- with .Text }}{{ . }}{{ end -}}
</a>
{{- /**/ -}}